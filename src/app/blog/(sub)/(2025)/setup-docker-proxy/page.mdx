---
title: Setting up a proxy for Docker 
description: A guide on how to set up a proxy for Docker to manage network traffic effectively.
date: 2025-11-04
author: KarChunT
tags: [Docker, Proxy, Networking]
documentation: https://docs.docker.com/engine/cli/proxy/
---

## Setting up a Proxy for Docker

To set up a proxy for Docker, you need to **configure the Docker Daemon** and the **Docker Client** to **use the proxy server**. This is particularly useful in environments where direct internet access is restricted.

You will need to configure
- Docker Client - to set proxy environment variables for **containers started by the Docker CLI**.
- Docker Daemon - to set proxy environment variables for the **Docker service itself** (for pulling images, etc.).

<Steps>
### Configure the Docker Client

<Callout title="More Information">
  If you don't want to configure the proxy for Docker client, you can also set the proxy configuration on the command line when running or building containers, like this:

  ```bash
  docker build --build-arg HTTP_PROXY=http://your-proxy-server:port .
  docker run -e HTTP_PROXY=http://your-proxy-server:port <image>
  ```

  But configuring it in the Docker client configuration file is more convenient for regular use.

  <Callout type="warn">
    Please don't use `ENV` in Dockerfile to set proxy for Docker client, as it will **bake the proxy settings into the image**, which may not be desirable. Use the methods mentioned above instead.
  </Callout>
</Callout>

Basically, you need to create or modify the `config.json` file located in the Docker configuration directory (usually `~/.docker/` on Linux and macOS, and `%USERPROFILE%\.docker\` on Windows).

The following configuration sets proxy environment variables for **Docker containers** started by the Docker CLI (client), but **does not configure proxy settings for the Docker Daemon** itself.

```json filename="~/.docker/config.json"
{
  "proxies": {
    "default": {
      "httpProxy": "http://your-proxy-server:port",
      "httpsProxy": "http://your-proxy-server:port",
      "noProxy": "localhost,.local,127.0.0.1,.example.org,*.yourdomain.com"
    }
  }
}
```

After you create or modify the file, when you run Docker commands that start containers, the **specified proxy settings will be applied** to those containers.

```bash
docker run <image> sh -c 'env | grep -i _proxy'

# You should see output similar to:
http_proxy=http://your-proxy-server:port
https_proxy=http://your-proxy-server:port
no_proxy=localhost,.local,127.0.0.1,.example.org,*.yourdomain.com
```

### Configure the Docker Daemon

<Callout title="References">
  You can refer https://docs.docker.com/engine/daemon/proxy/ for more details like **Rootless mode**, etc.
</Callout>

If you want to **pull images or interact with registries through a proxy**, you need to configure the Docker Daemon to use the proxy server. Normally, Docker Daemon will **run as a systemd service** on Linux.

1. Create a directory for Docker service overrides

    ```bash
    sudo mkdir -p /etc/systemd/system/docker.service.d
    ```

2. Create a configuration file (`/etc/systemd/system/docker.service.d/http-proxy.conf`) for the proxy settings.
    ```bash filename="/etc/systemd/system/docker.service.d/http-proxy.conf"
    [Service]
    Environment="HTTP_PROXY=http://your-proxy-server:port"
    Environment="HTTPS_PROXY=http://your-proxy-server:port"
    Environment="NO_PROXY=localhost,.local,127.0.0.1,.example.org,*.yourdomain.com"
    ```

3. Reload the systemd daemon and restart Docker

    ```bash
    sudo systemctl daemon-reload
    sudo systemctl restart docker # or sudo systemctl restart docker.service
    ```

4. Verify the proxy settings are applied to the Docker Daemon

    ```bash
    sudo systemctl show --property=Environment docker
    ```

---

<Callout title="daemon.json">
  You can also set proxy settings in the `/etc/docker/daemon.json` file by adding the following configuration, but this method is **less common** as compared to using systemd service overrides:

  ```json filename="/etc/docker/daemon.json"
  {
    "proxies": {
      "http-proxy": "http://your-proxy-server:port",
      "https-proxy": "http://your-proxy-server:port",
      "no-proxy": "localhost,.local,127.0.0.1,.example.org,*.yourdomain.com"
    }
  }
  ```

  After modifying the file, restart the Docker service to apply the changes:

  ```bash
  sudo systemctl restart docker
  ```
</Callout>

</Steps>

<Comments />